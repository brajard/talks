% !TEX encoding = UTF-8 Unicode
% -*- coding: UTF-8; -*-
\ifdefined\ishandout
\documentclass[handout]{beamer}
\else
\documentclass[11pt]{beamer}
\fi

\usepackage[frenchb]{babel}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage{hyperref}
\usepackage{multirow}
\usepackage{listings}
\usepackage{fancyvrb}
\usepackage{tikz}
\usepackage{framed}
\usepackage{algorithm}
\usepackage{algorithmic}
\usepackage{xcolor}
\usepackage{color, colortbl}
\ifdefined\ishandout
\usepackage{handoutWithNotes}
\fi
\usepackage{slashbox}
\usepackage{amsmath}
\usepackage{bm}
\usepackage{hhline}
\usepackage{xmpmulti}
\usepackage{pgfplots}
\usetikzlibrary{shapes.geometric}
\usetikzlibrary{positioning}
\usetikzlibrary{shapes.arrows, chains}
\usetikzlibrary{arrows,calc}
\usetikzlibrary{shapes.multipart}
\usepackage{array}
\usetheme{Boadilla}

\usefonttheme[onlymath]{serif}

\newcommand{\R}{\mathbb{R}}
\newcommand{\C}{\mathbb{C}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\E}{\mathbb{E}}
\newcommand{\Var}{\text{Var}}
\newcommand{\Cov}{\text{Cov}}
\ifdefined\ishandout
\pgfpagesuselayout{3 on 1 with notes}[a4paper,border shrink=5mm]
\usecolortheme{dove}
\else
%\usecolortheme{dolphin}
\usecolortheme{beaver}
\fi


\lstnewenvironment{codeC}
{ \lstset{language=C,
    otherkeywords={printf,scanf}}
}
{}

\ifdefined\ishandout
\definecolor{mygreen}{rgb}{0,0,0}
\definecolor{mymauve}{rgb}{0,0,0}
\definecolor{myblue}{rgb}{0,0,0}
\else
\definecolor{mygreen}{rgb}{0,0.6,0}
\definecolor{mymauve}{rgb}{0.58,0,0.82}
\definecolor{myblue}{rgb}{0,0,1}

\fi

%% Notes
%\setbeameroption{show only notes}


\definecolor{mygray}{rgb}{0.5,0.5,0.5}

\lstset{ language=Python,%
  backgroundcolor=\color{white},   % choose the background color; you must add \usepackage{color} or \usepackage{xcolor}
  basicstyle=\footnotesize,        % the size of the fonts that are used for the code
  breakatwhitespace=false,         % sets if automatic breaks should only happen at whitespace
  breaklines=true,                 % sets automatic line breaking
  captionpos=b,                    % sets the caption-position to bottom
  commentstyle=\color{mygreen},    % comment style
  deletekeywords={...},            % if you want to delete keywords from the given language
  escapeinside={\%*}{*)},          % if you want to add LaTeX within your code
  extendedchars=true,              % lets you use non-ASCII characters; for 8-bits encodings only, does not work with UTF-8
  frame=tb,	                   % adds a frame around the code
  keepspaces=true,                 % keeps spaces in text, useful for keeping indentation of code (possibly needs columns=flexible)
  keywordstyle=\color{blue},       % keyword style
  otherkeywords={*,...},           % if you want to add more keywords to the set
  numbers=none,                    % where to put the line-numbers; possible values are (none, left, right)
  numbersep=5pt,                   % how far the line-numbers are from the code
  numberstyle=\tiny\color{mygray}, % the style that is used for the line-numbers
  rulecolor=\color{black},         % if not set, the frame-color may be changed on line-breaks within not-black text (e.g. comments (green here))
  showspaces=false,                % show spaces everywhere adding particular underscores; it overrides 'showstringspaces'
  showstringspaces=false,          % underline spaces within strings only
  showtabs=false,                  % show tabs within strings adding particular underscores
  stepnumber=2,                    % the step between two line-numbers. If it's 1, each line will be numbered
  stringstyle=\color{mymauve},     % string literal style
  tabsize=3,	                   % sets default tabsize to 2 spaces
  title=\lstname                   % show the filename of files included with \lstinputlisting; also try caption instead of title
}
%\lstset{language=Python,
% breakatwhitespace=false,         % sets if automatic breaks should only happen at whitespace
%  breaklines=true,                 % sets automatic line breaking
%  captionpos=b,                
%%commentstyle=\itshape\color{mymauve},
%%keywordstyle=\bfseries\color{myblue},
%numbers=left,                    % where to put the line-numbers; possible values are (none, left, right)
%  numbersep=8pt,                   % how far the line-numbers are from the code
%  numberstyle=\tiny\color{mygray}, % the style that is used for the line-numbers
%%  rulecolor=\color{black},         % if not set, the frame-color may be changed on line-breaks within not-black text (e.g. comments (green here))
%  showspaces=false,                % show spaces everywhere adding particular underscores; it overrides 'showstringspaces'
%%  showstringspaces=false,          % underline spaces within strings only
%  showtabs=false,                  % show tabs within strings adding particular underscores
%  stepnumber=2,                    % the step between two line-numbers. If it's 1, each line will be numbered
%%  stringstyle=\color{mygreen},     % string literal style
%  tabsize=2 
%}
\ifdefined\ishandout
\newcommand{\red}{\textbf}
\else
\newcommand{\red}{\textcolor{red}}
\fi
%\newcommand \emph
%Default size : 12.8 cm * 9.6 cm

\newcommand{\tmark}[1]{\tikz[remember picture, baseline=-.5ex]{\coordinate(#1);}}

\ifdefined\ishandout
\newenvironment<>{codeblock}[1]{%begin
  \setbeamercolor{block title}{fg=black,bg=lightgray!80}%
  \begin{block}{#1}}
  % \begin{codeC}}
  %  {\end{codeC}
{  
\end{block}}

\newenvironment<>{termblock}[1]{
    \setbeamercolor{block title}{fg=black,bg=lightgray!90}%
    \begin{block}{#1}
}
%     \begin{Verbatim}}
{%\end{Verbatim}
\end{block}
}

\definecolor{bluegreen}{RGB}{0,0,0}
%\definecolor{bluegreen}{rgb}{0,0.6,0.8}
\else

\newenvironment<>{codeblock}[1]{%begin
  \setbeamercolor{block title}{fg=darkgray,bg=yellow}%
  \begin{block}{#1}}
  % \begin{codeC}}
  %  {\end{codeC}
{  
\end{block}}

\newenvironment<>{termblock}[1]{
    \setbeamercolor{block title}{fg=white,bg=lightgray}%
    \begin{block}{#1}}
%     \begin{Verbatim}}
{%\end{Verbatim}
\end{block}
}

\definecolor{bluegreen}{RGB}{0,149,182}
%\definecolor{bluegreen}{rgb}{0,0.6,0.8}
\fi

%\newcommand{\output}[1]{
\setbeamertemplate{navigation symbols}{}
\newcommand{\bvrb}{\Verb[commandchars=Â£ÂµÂ§,formatcom=\color{bluegreen}]}
\newcommand{\footvrb}{\footnotesize\Verb}
\newcommand{\vrbalert}[2][]{\visible<#1>{#2}}
%%% Commande pour les listes/arbres
\newcommand{\mvide}{\nodepart{one} \nodepart{two}}
\newcommand{\tvide}{\nodepart{one} \nodepart{two} \nodepart{three}}
\newcommand{\rref}[1][]{\hfill{\scriptsize\textit{#1}}}


\newcommand{\odif}[2]{\frac{d #1}{d #2}} 
%%Fin des commandes pour les listes/arbres.
\newcommand{\gooditem}[1]{\setbeamercolor{item}{fg=green}\item #1} 
\newcommand{\pooritem}[1]{\setbeamercolor{item}{fg=red}\item #1} 
\setbeamerfont{caption}{size=\scriptsize}

%%% ParamÃ¨tres du cours (Ã  rÃ©gler)
%NumÃ©ro du cours
\newcommand{\nb}{1}

\title[machine learning]{Machine Learning à l'IPSL}
\author[J. Brajard]{J. Brajard, L. Barthes, O. Bouchet, R. Hourani, C. Mallet, E. de Bezenac, O. Schwander, S. Thiria}

\institute[LOCEAN/SU]{LOCEAN-SU}
\date{13 Mars 2018}
\begin{document}
\tikzstyle{every picture}+=[remember picture]
%%%%%%%%%%%%%%%%%%%%% SLIDES DE TITRE
\begin{frame}
\titlepage
%\centering{
%\url{http://australe.upmc.fr} (onglet EPU-C5-IGE Info Gen)}
\end{frame}

%%%%%%%%%%%%%%%%%%%%
\begin{frame}
\frametitle{What is machine learning ?}
\begin{block}{A machine}
\begin{equation*}
y = \mathcal{M}(x,\theta)
\end{equation*}
\begin{itemize}
\item $x$: input
\item $y$: output
\item $\mathcal{M}$: a model (named "machine")
\item $\theta$ : parameters of the model $\mathcal{M}$.
\end{itemize}
\end{block}
\alert{Machine learning} consists in optimizing $\theta$ using a set of data. 
This is the training process.
\end{frame}



%%%%%%%%%%%%%%%%%%%%
\begin{frame}
\frametitle{Example 1: Computer Vision}
\begin{figure}
\includegraphics[width=\textwidth]{./figs/compute-vision.png}
\end{figure}
\rref[Li, Karpathy and Johnson, 2016, Stanford CS231n course]

\end{frame}


%%%%%%%%%%%%%%%%%%%%
\begin{frame}
\frametitle{Example 1: Computer Vision}
\framesubtitle{Image Net Large Scale Recogonition Challenge (ILSVRC)}
\begin{figure}

\begin{tikzpicture} [scale=0.8, every node/.style={scale=0.6}]
  \begin{axis}[ 
    x tick label style={ 
      /pgf/number format/1000 sep=}, 
    ylabel=Classification error, 
    xtick={2010,2011,2012,2013,2014,2015,2016,2017},
    xticklabels={2010,2011,2012,2013,2014,2015,2016,hum.},
    enlargelimits=0.15, 
     bar width=7pt, 
    ybar,
   legend style={at={(0.5,-0.15)},
     anchor=north,legend columns=-1}, 
   x tick label style={font=\footnotesize,rotate=45, anchor=east},
   very axis plot/.append style={
      ybar,
      bar width=.2,
      bar shift=0pt,
      fill},
      nodes near coords,
   ] 
   \addplot[ybar,fill=blue!60, bar shift=0pt]
   coordinates {(2010,28) (2011,26)}; 
   \addplot[ybar,fill=red!60]
   coordinates {(2012,16) (2013,12) (2014,7) (2015,3.6) (2016,3)}; 
   \addplot[ybar,fill=green!60, bar shift=0pt] 
   coordinates 
   {(2017,5.1)};  
   \legend{traditional algo.,Deep Learning,Human}
 \end{axis} 
\end{tikzpicture}
\end{figure}
Deep learning architectures was based on Convolutional Neural Networks (CNN).
\end{frame}



%%%%%%%%%%%%%%%%%%%%
\begin{frame}
\frametitle{Machine Translation}
Objective : translate a text from a language to another.
\begin{figure}
\includegraphics[width=.6\textwidth]{./figs/google-trad.png}
\end{figure}
\begin{itemize}
\item Oct. 2013: Pionneering scientic paper about neural networks in machine translation(Kalchbrenner, N., and Blunsom, P).
\item 2016: Neural machine translation outperform tradiational approaches on public benchmarks
\item 2017: Major systems (Google, Systran, WIPO, Microsoft) switch to
  neural machine translation  (using deep recurrent neural networks)
\end{itemize}
\end{frame}


%%%%%%%%%%%%%%%%%%%%
\begin{frame}
\frametitle{Playing Games}
\begin{columns}
\column{.5\textwidth}
\begin{itemize}
\item 1997: Deep Blue defeats Kasparov at Chess.
\item 2016: AlphaGo's victory again Lee Sedol at Go.
\item 2017: AphaGo Zero learns how to play Go only by playing against
  itself. It outperformed previous AlphaGo version (Reinforcement
  learning)
\item 2017: DeepStack beats professional human poker players.
\end{itemize}
\column{.5\textwidth}
\includegraphics[width=\textwidth]{./figs/alphago.jpg}
\end{columns}
\end{frame}

%%%%%%%%%%%%%%%%%%%%
\begin{frame}
\frametitle{Link between climate-related study and machine learning }
\begin{figure}
\includegraphics[height=.7\textheight]{./figs/nature.png}
\end{figure}
\rref[Jones, Nature 548, 379–380 (24 August 2017)]
\end{frame}

%%%%%%%%%%%%%%%%%%%%
\begin{frame}
\frametitle{Some problems to be addressed by machine learning ?}
A non-exhaustive list:
\begin{itemize}
\item Forecasting
\item Nowcasting
\item Model aggregation
\item Feature identification
\item Parameter estimation
\item Quality control
\item ...
\end{itemize}
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}
\frametitle{Contexte institutionnel à l'IPSL (et au-delà)}

\begin{itemize}[<+->]
\item Projet européen de recherche et d'innovation (RIA) sur l'Intelligence Artificiel.\\
Importance des enjeux sociétaux et économiques, et notamment construction d'un volet "Climat"\\
{\scriptsize\url{http://ec.europa.eu/research/participants/portal/desktop/en/opportunities/h2020/topics/ict-26-2018-2020.html}}
\item Projets "Make ou planet great again", lauréat Pr V. Balaji (Automn 2018).\\
Utiliser des simulations hautes résolutions afin de mieux représenter l'effet des nuages dans les modèles de climat.
\item Projet "Extreme earth" (porté par ECMWF)\\
Représentation et prédiction d'évènements extrêmes (avec une composante Big Data, Deep learning)\\
{\scriptsize\url{www.extremearth.eu}}
\item Plus local : groupe de travail "SAMA-Machine Learning"
\end{itemize}
\end{frame}

%%%%%%%%%%%%%%%%%%%%
\begin{frame}
  \frametitle{La formation en Machine Learning à l'IPSL}

  \begin{columns}
    \column{.78\textwidth}
    \footnotesize
    \begin{block}{Master TRIED depuis 1998 (28 inscits en 2017)}
        \begin{itemize}
        \item Exploration de données multidimentionnelles 
        \item Apprentissage statistique 
        \item Réseaux de neurones
        \item Reconnaissance des Formes 
        \item \alert{Projets d’initiation à la recherche en science des données à L’IPSL}
      \end{itemize}
    \end{block}
    \column{.2\textwidth}
    \begin{figure}
      \includegraphics[width=\textwidth]{./figs/logo-saclay.jpg}
    \end{figure}
  \end{columns}
\pause
  \footnotesize
  \begin{block}{Portail e-learning de l’IPSL}
    \url{https://claroline.locean-ipsl.upmc.fr}
    \begin{itemize}
    \item cours Perceptron multicouche, cartes auto-organisatrices
    \item Travaux pratiques en science de l’environnement 
    \item Études de cas en télédétection
    \item Notebook Ipython	
    \item \alert{Module Apprentissage Statistique Ecole Doctorale  de l’IPSL}
    \end{itemize}
  \end{block}
\end{frame}

%%%%%%%%%%%%%%%%%%%%
\begin{frame}
\frametitle{Le groupe de travail SAMA-Machine learning}
\begin{itemize}
\item Existe depuis Octobre 2017
\item Réunit des chercheurs, ingénieurs de l'IPSL, du LIP6 et de
  l'ENSIEE.
\begin{figure}
\begin{tabular}{ccc}
\includegraphics[height=1cm]{./figs/logo_IPSL.png}&
\includegraphics[height=1cm]{./figs/logo_LIP6.png}&
\includegraphics[height=1cm]{./figs/logo_ENSIEE.jpg}\\
\end{tabular}
\end{figure}
\item Réunion une fois par mois
\item Un (ou deux) présentations scientifiques par réunion
\item Définition collectivement de sujets de recherche, de stages, ...
\end{itemize}
\end{frame}



%%%%%%%%%%%%%%%%%%%%
\begin{frame}
\frametitle{Some problems to be addressed by machine learning ?}
A non-exhaustive list:
\begin{itemize}
\item Forecasting
  \visible<2->{
    \begin{itemize}
    \item Sea surface temperature advection
    \end{itemize}
  }
\item Nowcasting
  \visible<2->{
    \begin{itemize}
    \item Rain cells nowcasting from radar data
    \item \alert<3>{Total suspended matter (sea surface satellite images)}
    \end{itemize}
  }
\item Model aggregation
  \visible<2->{
    \begin{itemize}
    \item CMIP5 model ranking on senegal upwelling representation.
    \end{itemize}
  }
\item Feature identification
  \visible<2->{
    \begin{itemize}
    \item Eddy detection over Mediterranean Sea.
    \item Data-driven clustering of rain events
    \end{itemize}
  }
\item Parameter estimation
  \visible<2->{
    \begin{itemize}
      \item \alert<4>{Completion (inpainting) of satellite data under clouds.}
      \item \alert<5>{Parametrization of sub-scale processes in numerical models.}
      \item Phytoplancton type estimation from satellite images.
    \end{itemize}
  }
\item \alert<6>{Quality control}
\end{itemize}
\end{frame}


%%%%%%%%%%%%%%%%%%%%
\begin{frame}[t]
\frametitle{Data-driven clustering of rain events}

\alert{Objective:} Selection of an optimal number of indicators to classify rain events and infer
non-obbservable parameters\\
\alert{Model:} genetic algorithm, self-organizing map.
\begin{columns}[t]

\column{.4\textwidth}
\footnotesize
\begin{enumerate}
\item<2-> Select S indicators among N candidates for a optimal clustering of rain events (N=23)
\item<3-> Result : coherent clustering of rain events using a small number of parameters (S=5)
\end{enumerate}
\begin{figure}
\includegraphics<3>[width=.55\textwidth]{./figs/rain-class.png}
\end{figure}
\column{.6\textwidth}
\begin{figure}
\includegraphics<2>[width=\textwidth]{./figs/rain-gen.png}
\includegraphics<3>[width=\textwidth]{./figs/rain-res.png}
\rref[Dilmi et al. 2017]
\end{figure}
\end{columns}
\end{frame}

%%%%%%%%%%%%%%%%%%%%
\begin{frame}
\frametitle{Detection of phytoplankton groups from satellite images}
\alert{Objective:}Estimate some pigments of phytoplantkton from satellite ocean color images\\
\alert{Model:} Self-organizing map with incomplete data
\pause
\begin{figure}
\includegraphics[width=.8\textwidth]{./figs/phyto.pdf}
\end{figure}
Training set: 5500 in-situ data (MAREDAT global database)
\rref[Hourani et al. 2017]
\end{frame}


%%%%%%%%%%%%%%%%%%%%
\begin{frame}
\frametitle{Sea Surface Temperature forecast (SST)}
\alert{Objective:} predict daily SST images from past SST images.\\
\alert{Model:} Combination of a convolutive neural network model for motion estimate and a warping scheme to advect the input image.
\begin{figure}
\begin{tikzpicture}
\begin{scope}[text width=8em,anchor=east, align=right]
\node (line2) {Deep learning forecast};
\node [above of = line2,node distance = 1.2cm] (line1) {Reanalysis (truth)};
\node [below of = line2,node distance = 2cm] (line3) {Motion estimate};
\end{scope}
\node [right of = line2, anchor=west, node distance = 1.8cm] (im) {\includegraphics[height=5cm]{./figs/sst.png}};
\end{tikzpicture}
\end{figure}
\rref[De Bezenac et al. 2017]

\end{frame}


%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}
\frametitle{Evaluate CMIP5 models about upwelling representation}
\alert{Objective:} Compare, evaluate (and combine) climate model outputs.\\
\alert{Model:} Clustering using Self-Organizing-Maps.
\begin{figure}
\includegraphics<1>[width=\textwidth]{./figs/upwelling-cl.png}
\includegraphics<2>[width=.65\textwidth]{./figs/upwelling-diag.png}
\end{figure}

\end{frame}


%%%%%%%%%%%%%%%%%%%%
\begin{frame}
\frametitle{Les besoins pour le futur}
\begin{itemize}
\item<1-> Renforcer les liens entre formations (Master) de l'IPSL et les
  UFR d'ingénierie.
\begin{itemize}
\item Stage pluri-disciplinaires
\end{itemize}
\item<2-> Mieux cibler les grandes questions scientifiques liées à l'apprentissage automatique.
\item<3-> Améliorer la visibilité d'apprentissage automatique à l'IPSL.
\item<4-> Bénéficier d'une infrastructure technique permettant la mise aux
  point des algorithmes d'apprentissage (apprentissage profond, ...).
\item<5-> Structurer la recherche en apprentissage automatique sur les
  thèmes du climat et des sciences de l'environnement en lien avec
  d'autres équipes (nationales et internationales).
\begin{itemize}
\item AMS: Committee on Artificial Intelligence Applications to
  Environmental Science
\item ...
\end{itemize}
\end{itemize}

\end{frame}


\end{document}